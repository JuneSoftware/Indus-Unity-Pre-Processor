name: Mixed inputs

on:
  workflow_dispatch:
    inputs:
      buildEnvironment:
        type: choice
        description: Build Environment
        options:
        - Development
        - Production
      buildTargetOne:
        type: choice
        description: Build Target
        options: 
        - Android
        - iOS
        - Windows 
        - Windows Server
        - Linux Server
      buildTargetTwo:
        type: choice
        description: Build Target
        options: 
        - Android
        - iOS
        - Windows 
        - Windows Server
        - Linux Server
      buildTargetThree:
        type: choice
        description: Build Target
        options: 
        - Android
        - iOS
        - Windows 
        - Windows Server
        - Linux Server
      buildTargetFour:
        type: choice
        description: Build Target
        options: 
        - Android
        - iOS
        - Windows 
        - Windows Server
        - Linux Server

jobs:
  preBuilds:
    runs-on: ubuntu-latest
    outputs:
      result: ${{ steps.buildMatrix.outputs.selectedTarget }}
    steps:
    - uses: actions/checkout@v2
    - uses: ./
      name: Build Matrix
      id: buildMatrix
      with: 
        buildEnvironment: "${{ github.event.inputs.buildEnvironment }}"
        buildTargetOne: "${{ github.event.inputs.buildTargetOne }}"
        buildTargetTwo: "${{ github.event.inputs.buildTargetTwo }}"
        buildTargetThree: "${{ github.event.inputs.buildTargetThree }}"
        buildTargetFour: "${{ github.event.inputs.buildTargetFour }}"
    - name: Send greeting
      run: echo "${{ steps.buildMatrix.outputs.selectedTarget }}" 
  build: #To create the builds
    needs: preBuilds
    name: Build for ${{ matrix.targetPlatform.subPlatform }}
    runs-on: self-hosted-windows
    outputs:
      buildResult: ${{ steps.buildStep.outcome }}
    strategy:
      fail-fast: false
      matrix:
        targetPlatform: ${{ fromJson(needs.preBuilds.outputs.result) }}
    steps:
      - name: Check Out
        run: echo "${{ matrix.targetPlatform.platform }}" 